//
// Module mopshub_lib.monitor_bus.struct
//
// Created:
//          by - dcs.dcs (chipdev2.physik.uni-wuppertal.de)
//          at - 13:05:30 03/29/23
//
// Generated by Mentor Graphics' HDL Designer(TM) 2019.4 (Build 4)
//

`resetall
`timescale 1ns/10ps
module monitor_bus( 
   // Port Declarations
   input   wire            clk, 
   input   wire    [7:0]   data_init, 
   input   wire    [7:0]   data_tra_spi_out,    // Output data to be written on the CAN bus
   input   wire            miso, 
   input   wire    [4:0]   n_buses, 
   input   wire            rst, 
   input   wire            rst_mon_cnt, 
   input   wire    [7:0]   spi_id, 
   input   wire    [7:0]   spi_reg, 
   input   wire    [7:0]   spi_select, 
   input   wire            start_mon_cnt, 
   input   wire            start_mon_init, 
   input   wire            start_read_miso, 
   input   wire            transceive, 
   output  wire    [31:0]  data_rec_spi_in, 
   output  reg             end_mon_cnt, 
   output  wire            end_read_miso, 
   output  wire    [4:0]   mon_bus_cnt_active, 
   output  wire            mosi, 
   output  wire            sck, 
   output  wire            w_Master_TX_Ready
);


// Internal Declarations


// Local declarations

// Internal signal declarations
wire        SPI_MODE;
reg         clk_en;
wire        fifo_empty;
wire  [4:0] mon_bus_cnt;
wire  [7:0] o_RX_Byte;
wire        o_RX_DV;
reg         rena;
wire  [7:0] rxdat;
wire  [7:0] txdat;

// ModuleWare signal declarations(v1.12) for instance 'spi_bus_fifo' of 'fifo'
reg [7:0] mw_spi_bus_fiforeg_cval0;
reg [7:0] mw_spi_bus_fiforeg_cval1;
reg [7:0] mw_spi_bus_fiforeg_cval2;
reg [7:0] mw_spi_bus_fiforeg_cval3;
reg [7:0] mw_spi_bus_fiforeg_cval4;
reg [7:0] mw_spi_bus_fiforeg_cval5;
reg [7:0] mw_spi_bus_fiforeg_cval6;
reg [7:0] mw_spi_bus_fiforeg_cval7;
reg [7:0] mw_spi_bus_fiforeg_cval8;
reg [7:0] mw_spi_bus_fiforeg_cval9;
reg [7:0] mw_spi_bus_fiforeg_cval10;
reg [7:0] mw_spi_bus_fiforeg_cval11;
reg [7:0] mw_spi_bus_fiforeg_cval12;
reg [7:0] mw_spi_bus_fiforeg_cval13;
reg [7:0] mw_spi_bus_fiforeg_cval14;
reg [7:0] mw_spi_bus_fiforeg_cval15;
reg [7:0] mw_spi_bus_fiforeg_cval16;
reg [7:0] mw_spi_bus_fiforeg_cval17;
reg [7:0] mw_spi_bus_fiforeg_cval18;
reg [7:0] mw_spi_bus_fiforeg_cval19;
reg [7:0] mw_spi_bus_fiforeg_cval20;
wire [7:0] mw_spi_bus_fiforeg_nval0;
wire [7:0] mw_spi_bus_fiforeg_nval1;
wire [7:0] mw_spi_bus_fiforeg_nval2;
wire [7:0] mw_spi_bus_fiforeg_nval3;
wire [7:0] mw_spi_bus_fiforeg_nval4;
wire [7:0] mw_spi_bus_fiforeg_nval5;
wire [7:0] mw_spi_bus_fiforeg_nval6;
wire [7:0] mw_spi_bus_fiforeg_nval7;
wire [7:0] mw_spi_bus_fiforeg_nval8;
wire [7:0] mw_spi_bus_fiforeg_nval9;
wire [7:0] mw_spi_bus_fiforeg_nval10;
wire [7:0] mw_spi_bus_fiforeg_nval11;
wire [7:0] mw_spi_bus_fiforeg_nval12;
wire [7:0] mw_spi_bus_fiforeg_nval13;
wire [7:0] mw_spi_bus_fiforeg_nval14;
wire [7:0] mw_spi_bus_fiforeg_nval15;
wire [7:0] mw_spi_bus_fiforeg_nval16;
wire [7:0] mw_spi_bus_fiforeg_nval17;
wire [7:0] mw_spi_bus_fiforeg_nval18;
wire [7:0] mw_spi_bus_fiforeg_nval19;
wire [7:0] mw_spi_bus_fiforeg_nval20;
wire mw_spi_bus_fifotemp_rena;
wire mw_spi_bus_fifotemp_wena;
wire mw_spi_bus_fifotemp_full;
wire mw_spi_bus_fifotemp_empty;
reg [4:0] mw_spi_bus_fifoaddr_cval;
wire [4:0] mw_spi_bus_fifoaddr_nval;


// Instances 
bit_counter bit_counter_trim( 
   .ext_rst    (rst_mon_cnt), 
   .rst        (rst), 
   .data_out   (mon_bus_cnt), 
   .clk        (clk), 
   .cnt_enable (start_mon_cnt)
); 

buffer_rec_spi_data buffer_rec_spi_data0( 
   .clk           (clk), 
   .rst           (rst), 
   .buffer_en     (start_read_miso), 
   .spi_id_in     (spi_id), 
   .spi_reg       (spi_reg), 
   .data_rec_in   (rxdat), 
   .spi_select    (spi_select), 
   .end_read_miso (end_read_miso), 
   .data_rec_out  (data_rec_spi_in)
); 

spi_master spi_master_monitor( 
   .i_Rst_L    (rst), 
   .i_Clk      (clk), 
   .SPI_MODE   (SPI_MODE), 
   .i_TX_Byte  (txdat), 
   .i_TX_DV    (transceive), 
   .o_TX_Ready (w_Master_TX_Ready), 
   .o_RX_DV    (o_RX_DV), 
   .o_RX_Byte  (o_RX_Byte), 
   .o_SPI_Clk  (sck), 
   .i_SPI_MISO (miso), 
   .o_SPI_MOSI (mosi)
); 

// HDL Embedded Text Block 6 eb6
assign SPI_MODE     = 1'b0;
initial end_mon_cnt = 1'b0;
initial clk_en      = 1'b1;
assign mon_bus_cnt_active = (start_mon_init ==1)? mon_bus_cnt : spi_select[4:0];
assign txdat = data_init;//(start_mon_init ==1)? data_init : data_tra_spi_out;




// Counter end_osc_cnt over the Clock signal
always @(posedge clk)
begin
  if (!rst) end_mon_cnt <= 0;
  else 
    case(mon_bus_cnt)
     n_buses: end_mon_cnt <= 1;
     default: end_mon_cnt <= 0;
    endcase
end



//FIFO block
always @(posedge clk)
begin
  if (!rst) rena <= 0;
  else if (!fifo_empty) rena <= 1;
  else rena <= 0;
end






























// ModuleWare code(v1.12) for instance 'spi_bus_fifo' of 'fifo'
assign fifo_empty = mw_spi_bus_fifotemp_empty;
assign rxdat = mw_spi_bus_fiforeg_cval0;
assign mw_spi_bus_fifotemp_rena = rst & rena & ~mw_spi_bus_fifotemp_empty;
assign mw_spi_bus_fifotemp_wena = rst & o_RX_DV & ~mw_spi_bus_fifotemp_full;
assign mw_spi_bus_fifotemp_empty = (mw_spi_bus_fifoaddr_cval == 0);
assign mw_spi_bus_fifotemp_full = (mw_spi_bus_fifoaddr_cval == 20);

assign mw_spi_bus_fifoaddr_nval = (~rst) ? 0
   : mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? mw_spi_bus_fifoaddr_cval : mw_spi_bus_fifoaddr_cval + 1'b1
   : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fifoaddr_cval - 1'b1
   : mw_spi_bus_fifoaddr_cval;
always @(posedge clk)
begin : spi_bus_fifoseq_proc
   if (clk_en)
      mw_spi_bus_fifoaddr_cval = mw_spi_bus_fifoaddr_nval;
end

always @(posedge clk)
begin : spi_bus_fifomove_proc
   if (clk_en)
   begin
      mw_spi_bus_fiforeg_cval0[7:0]  = mw_spi_bus_fiforeg_nval0[7:0] ;
      mw_spi_bus_fiforeg_cval1[7:0]  = mw_spi_bus_fiforeg_nval1[7:0] ;
      mw_spi_bus_fiforeg_cval2[7:0]  = mw_spi_bus_fiforeg_nval2[7:0] ;
      mw_spi_bus_fiforeg_cval3[7:0]  = mw_spi_bus_fiforeg_nval3[7:0] ;
      mw_spi_bus_fiforeg_cval4[7:0]  = mw_spi_bus_fiforeg_nval4[7:0] ;
      mw_spi_bus_fiforeg_cval5[7:0]  = mw_spi_bus_fiforeg_nval5[7:0] ;
      mw_spi_bus_fiforeg_cval6[7:0]  = mw_spi_bus_fiforeg_nval6[7:0] ;
      mw_spi_bus_fiforeg_cval7[7:0]  = mw_spi_bus_fiforeg_nval7[7:0] ;
      mw_spi_bus_fiforeg_cval8[7:0]  = mw_spi_bus_fiforeg_nval8[7:0] ;
      mw_spi_bus_fiforeg_cval9[7:0]  = mw_spi_bus_fiforeg_nval9[7:0] ;
      mw_spi_bus_fiforeg_cval10[7:0]  = mw_spi_bus_fiforeg_nval10[7:0] ;
      mw_spi_bus_fiforeg_cval11[7:0]  = mw_spi_bus_fiforeg_nval11[7:0] ;
      mw_spi_bus_fiforeg_cval12[7:0]  = mw_spi_bus_fiforeg_nval12[7:0] ;
      mw_spi_bus_fiforeg_cval13[7:0]  = mw_spi_bus_fiforeg_nval13[7:0] ;
      mw_spi_bus_fiforeg_cval14[7:0]  = mw_spi_bus_fiforeg_nval14[7:0] ;
      mw_spi_bus_fiforeg_cval15[7:0]  = mw_spi_bus_fiforeg_nval15[7:0] ;
      mw_spi_bus_fiforeg_cval16[7:0]  = mw_spi_bus_fiforeg_nval16[7:0] ;
      mw_spi_bus_fiforeg_cval17[7:0]  = mw_spi_bus_fiforeg_nval17[7:0] ;
      mw_spi_bus_fiforeg_cval18[7:0]  = mw_spi_bus_fiforeg_nval18[7:0] ;
      mw_spi_bus_fiforeg_cval19[7:0]  = mw_spi_bus_fiforeg_nval19[7:0] ;
      mw_spi_bus_fiforeg_cval20[7:0]  = mw_spi_bus_fiforeg_nval20[7:0] ;
   end
end
assign mw_spi_bus_fiforeg_nval0[7:0] = mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? (mw_spi_bus_fifoaddr_cval == 0) ? o_RX_Byte : mw_spi_bus_fiforeg_cval1[7:0] : mw_spi_bus_fiforeg_cval0[7:0] : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval1[7:0] : mw_spi_bus_fiforeg_cval0[7:0];
assign mw_spi_bus_fiforeg_nval1[7:0] = mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? (mw_spi_bus_fifoaddr_cval == 1) ? o_RX_Byte : mw_spi_bus_fiforeg_cval2[7:0]
    : (mw_spi_bus_fifoaddr_cval == 0) ? o_RX_Byte : mw_spi_bus_fiforeg_cval1[7:0]
    : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval2[7:0] : mw_spi_bus_fiforeg_cval1[7:0];
assign mw_spi_bus_fiforeg_nval2[7:0] = mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? (mw_spi_bus_fifoaddr_cval == 2) ? o_RX_Byte : mw_spi_bus_fiforeg_cval3[7:0]
    : (mw_spi_bus_fifoaddr_cval == 1) ? o_RX_Byte : mw_spi_bus_fiforeg_cval2[7:0]
    : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval3[7:0] : mw_spi_bus_fiforeg_cval2[7:0];
assign mw_spi_bus_fiforeg_nval3[7:0] = mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? (mw_spi_bus_fifoaddr_cval == 3) ? o_RX_Byte : mw_spi_bus_fiforeg_cval4[7:0]
    : (mw_spi_bus_fifoaddr_cval == 2) ? o_RX_Byte : mw_spi_bus_fiforeg_cval3[7:0]
    : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval4[7:0] : mw_spi_bus_fiforeg_cval3[7:0];
assign mw_spi_bus_fiforeg_nval4[7:0] = mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? (mw_spi_bus_fifoaddr_cval == 4) ? o_RX_Byte : mw_spi_bus_fiforeg_cval5[7:0]
    : (mw_spi_bus_fifoaddr_cval == 3) ? o_RX_Byte : mw_spi_bus_fiforeg_cval4[7:0]
    : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval5[7:0] : mw_spi_bus_fiforeg_cval4[7:0];
assign mw_spi_bus_fiforeg_nval5[7:0] = mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? (mw_spi_bus_fifoaddr_cval == 5) ? o_RX_Byte : mw_spi_bus_fiforeg_cval6[7:0]
    : (mw_spi_bus_fifoaddr_cval == 4) ? o_RX_Byte : mw_spi_bus_fiforeg_cval5[7:0]
    : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval6[7:0] : mw_spi_bus_fiforeg_cval5[7:0];
assign mw_spi_bus_fiforeg_nval6[7:0] = mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? (mw_spi_bus_fifoaddr_cval == 6) ? o_RX_Byte : mw_spi_bus_fiforeg_cval7[7:0]
    : (mw_spi_bus_fifoaddr_cval == 5) ? o_RX_Byte : mw_spi_bus_fiforeg_cval6[7:0]
    : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval7[7:0] : mw_spi_bus_fiforeg_cval6[7:0];
assign mw_spi_bus_fiforeg_nval7[7:0] = mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? (mw_spi_bus_fifoaddr_cval == 7) ? o_RX_Byte : mw_spi_bus_fiforeg_cval8[7:0]
    : (mw_spi_bus_fifoaddr_cval == 6) ? o_RX_Byte : mw_spi_bus_fiforeg_cval7[7:0]
    : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval8[7:0] : mw_spi_bus_fiforeg_cval7[7:0];
assign mw_spi_bus_fiforeg_nval8[7:0] = mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? (mw_spi_bus_fifoaddr_cval == 8) ? o_RX_Byte : mw_spi_bus_fiforeg_cval9[7:0]
    : (mw_spi_bus_fifoaddr_cval == 7) ? o_RX_Byte : mw_spi_bus_fiforeg_cval8[7:0]
    : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval9[7:0] : mw_spi_bus_fiforeg_cval8[7:0];
assign mw_spi_bus_fiforeg_nval9[7:0] = mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? (mw_spi_bus_fifoaddr_cval == 9) ? o_RX_Byte : mw_spi_bus_fiforeg_cval10[7:0]
    : (mw_spi_bus_fifoaddr_cval == 8) ? o_RX_Byte : mw_spi_bus_fiforeg_cval9[7:0]
    : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval10[7:0] : mw_spi_bus_fiforeg_cval9[7:0];
assign mw_spi_bus_fiforeg_nval10[7:0] = mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? (mw_spi_bus_fifoaddr_cval == 10) ? o_RX_Byte : mw_spi_bus_fiforeg_cval11[7:0]
    : (mw_spi_bus_fifoaddr_cval == 9) ? o_RX_Byte : mw_spi_bus_fiforeg_cval10[7:0]
    : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval11[7:0] : mw_spi_bus_fiforeg_cval10[7:0];
assign mw_spi_bus_fiforeg_nval11[7:0] = mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? (mw_spi_bus_fifoaddr_cval == 11) ? o_RX_Byte : mw_spi_bus_fiforeg_cval12[7:0]
    : (mw_spi_bus_fifoaddr_cval == 10) ? o_RX_Byte : mw_spi_bus_fiforeg_cval11[7:0]
    : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval12[7:0] : mw_spi_bus_fiforeg_cval11[7:0];
assign mw_spi_bus_fiforeg_nval12[7:0] = mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? (mw_spi_bus_fifoaddr_cval == 12) ? o_RX_Byte : mw_spi_bus_fiforeg_cval13[7:0]
    : (mw_spi_bus_fifoaddr_cval == 11) ? o_RX_Byte : mw_spi_bus_fiforeg_cval12[7:0]
    : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval13[7:0] : mw_spi_bus_fiforeg_cval12[7:0];
assign mw_spi_bus_fiforeg_nval13[7:0] = mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? (mw_spi_bus_fifoaddr_cval == 13) ? o_RX_Byte : mw_spi_bus_fiforeg_cval14[7:0]
    : (mw_spi_bus_fifoaddr_cval == 12) ? o_RX_Byte : mw_spi_bus_fiforeg_cval13[7:0]
    : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval14[7:0] : mw_spi_bus_fiforeg_cval13[7:0];
assign mw_spi_bus_fiforeg_nval14[7:0] = mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? (mw_spi_bus_fifoaddr_cval == 14) ? o_RX_Byte : mw_spi_bus_fiforeg_cval15[7:0]
    : (mw_spi_bus_fifoaddr_cval == 13) ? o_RX_Byte : mw_spi_bus_fiforeg_cval14[7:0]
    : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval15[7:0] : mw_spi_bus_fiforeg_cval14[7:0];
assign mw_spi_bus_fiforeg_nval15[7:0] = mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? (mw_spi_bus_fifoaddr_cval == 15) ? o_RX_Byte : mw_spi_bus_fiforeg_cval16[7:0]
    : (mw_spi_bus_fifoaddr_cval == 14) ? o_RX_Byte : mw_spi_bus_fiforeg_cval15[7:0]
    : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval16[7:0] : mw_spi_bus_fiforeg_cval15[7:0];
assign mw_spi_bus_fiforeg_nval16[7:0] = mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? (mw_spi_bus_fifoaddr_cval == 16) ? o_RX_Byte : mw_spi_bus_fiforeg_cval17[7:0]
    : (mw_spi_bus_fifoaddr_cval == 15) ? o_RX_Byte : mw_spi_bus_fiforeg_cval16[7:0]
    : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval17[7:0] : mw_spi_bus_fiforeg_cval16[7:0];
assign mw_spi_bus_fiforeg_nval17[7:0] = mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? (mw_spi_bus_fifoaddr_cval == 17) ? o_RX_Byte : mw_spi_bus_fiforeg_cval18[7:0]
    : (mw_spi_bus_fifoaddr_cval == 16) ? o_RX_Byte : mw_spi_bus_fiforeg_cval17[7:0]
    : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval18[7:0] : mw_spi_bus_fiforeg_cval17[7:0];
assign mw_spi_bus_fiforeg_nval18[7:0] = mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? (mw_spi_bus_fifoaddr_cval == 18) ? o_RX_Byte : mw_spi_bus_fiforeg_cval19[7:0]
    : (mw_spi_bus_fifoaddr_cval == 17) ? o_RX_Byte : mw_spi_bus_fiforeg_cval18[7:0]
    : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval19[7:0] : mw_spi_bus_fiforeg_cval18[7:0];
assign mw_spi_bus_fiforeg_nval19[7:0] = mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? (mw_spi_bus_fifoaddr_cval == 19) ? o_RX_Byte : mw_spi_bus_fiforeg_cval20[7:0]
    : (mw_spi_bus_fifoaddr_cval == 18) ? o_RX_Byte : mw_spi_bus_fiforeg_cval19[7:0]
    : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval20[7:0] : mw_spi_bus_fiforeg_cval19[7:0];
assign mw_spi_bus_fiforeg_nval20[7:0] = mw_spi_bus_fifotemp_wena ? mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval20[7:0]
    : (mw_spi_bus_fifoaddr_cval == 19) ? o_RX_Byte : mw_spi_bus_fiforeg_cval20[7:0]
    : mw_spi_bus_fifotemp_rena ? mw_spi_bus_fiforeg_cval20[7:0] : mw_spi_bus_fiforeg_cval20[7:0];

endmodule // monitor_bus

